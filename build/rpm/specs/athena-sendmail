Name: athena-sendmail
Summary: The Sendmail Mail Transport Agent, for Athena
Copyright: BSD
Group: System Environment/Daemons

Requires: athena-hesiod
Provides: smtpdaemon

%description
The Mail Transfer Agent for Athena.

%install
if [ X$RPM_BUILD_ROOT = X ]; then
  cat 1>&2 << MESSAGE
You must specify a build root in order to build this package.
Use the --buildroot option to RPM or the buildroot rpmrc entry.
MESSAGE
  exit 1
fi

rm -rf $RPM_BUILD_ROOT
mkdir $RPM_BUILD_ROOT
./do.sh -p -s /xxx -d $RPM_BUILD_ROOT install

# Extra files
mkdir -p $RPM_BUILD_ROOT/etc/rc.d/init.d
mkdir -p $RPM_BUILD_ROOT/etc/sysconfig
cp aliases $RPM_BUILD_ROOT/etc/aliases
cp sendmail.cf $RPM_BUILD_ROOT/etc/sendmail.cf
cp athena-sendmail.rc $RPM_BUILD_ROOT/etc/rc.d/init.d/athena-sendmail
cp athena-sendmail.conf $RPM_BUILD_ROOT/etc/sysconfig/athena-sendmail
chmod +x $RPM_BUILD_ROOT/etc/rc.d/init.d/athena-sendmail
chmod +x $RPM_BUILD_ROOT/etc/sysconfig/athena-sendmail
mkdir -p $RPM_BUILD_ROOT/var/spool/mqueue
ln -s ../sbin/sendmail $RPM_BUILD_ROOT/usr/lib/sendmail

%post
chkconfig --add athena-sendmail
/usr/sbin/sendmail -bi

%files
%config /etc/sendmail.st
%config /etc/aliases
%config /etc/sendmail.cf
%config /etc/sysconfig/athena-sendmail
%dir /var/spool/mqueue
/etc/rc.d
/usr/athena
/usr/bin
/usr/lib
/usr/libexec
/usr/sbin
