Name: athena-olc
Summary: The Athena Online Consultant system
License: MIT
Group: Applications/Communications

Requires: athena-krb5 athena-hesiod athena-zephyr athena-libet athena-openmotif
Requires: athena-libMu athena-wcl

%install
rm -rf $RPM_BUILD_ROOT
mkdir $RPM_BUILD_ROOT
./do.sh -p -s /xxx -d $RPM_BUILD_ROOT install

# Extra file
%ifos linux
mkdir -p $RPM_BUILD_ROOT/etc/rc.d/init.d
cp athena-olc.rc $RPM_BUILD_ROOT/etc/rc.d/init.d/athena-olc
chmod +x $RPM_BUILD_ROOT/etc/rc.d/init.d/athena-olc
%else
mkdir -p $RPM_BUILD_ROOT/etc/init.d
mkdir -p $RPM_BUILD_ROOT/etc/rc2.d
mkdir -p $RPM_BUILD_ROOT/etc/rc0.d
cp athena-olc.rc $RPM_BUILD_ROOT/etc/init.d/athena-olc
chmod +x $RPM_BUILD_ROOT/etc/init.d/athena-olc
ln -s ../init.d/athena-olc $RPM_BUILD_ROOT/etc/rc2.d/S91athena-olc
ln -s ../init.d/athena-olc $RPM_BUILD_ROOT/etc/rc0.d/K91athena-olc
%endif

find $RPM_BUILD_ROOT -type f -or -type l |
    sed -e "s|^$RPM_BUILD_ROOT||" | sort > rpm.filelist

%post
grep -q ^OLC /etc/athena/rc.conf || cat << EOF >> /etc/athena/rc.conf
OLC=false;		export OLC		#  OLC daemon?
EOF

%ifos linux
chkconfig --add athena-olc
%endif

%description
The Online Consultant system enables a variety of styles of
interaction with the Athena Online Consultants.

%ifos linux
%preun
if [ $1 = 0 ]; then
  chkconfig --del athena-olc
fi

%triggerpostun -- athena-olc < 9.2
chkconfig --del olc
%endif
