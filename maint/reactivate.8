.TH REACTIVATE 8 "25 May 1994"
.FM mit
.SH NAME
reactivate \- reset the state of an idle workstation
.SH SYNOPSIS
.B /etc/athena/reactivate
[
.B \-detach | \-prelogin
]
.SH DESCRIPTION
The
.I reactivate
script initializes an idle workstation and resets the state after a
user has logged out.  It is invoked regularly from
.I cron
and exits immediately if anyone is logged in, unless the
.B \-prelogin
option is specified.  It also exits if another
.I reactivate
process is found to be running.

When the workstation is idle,
.I reactivate
performs several tasks:
.TP
+ It disables logins for the duration of its execution.
.TP
* It flushes all filesystem authentication from the workstation.
.TP
* It resets the zephyr hostmanager (\fIzhm\fR).
.TP
* It destroys any ticket files remaining in /tmp.
.TP
+ It cleans out /tmp.
.TP
* It resets the password and group files to their default
contents.
.TP
+ It reconfigures some AFS state (including running config_afs).
.TP
* It runs cleanup.
.TP
+ It detaches all attached filesystems.
.TP
+ It attaches the appropriate system packs.
.TP
+ It invokes an automatic software update if available.
.TP
* It turns off remote network access to the workstation,
preventing unexpected and possibly hostile remote connections.
After logging in, you can use the
.I access_on
command to allow remote access.
.TP
+ It executes the local customizations in the file
.I /etc/athena/reactivate.local,
if it exists.
.PP
.SH OPTIONS
.TP
.B \-detach
causes
.I reactivate
to detach all attached filesystems.  This is not
done on every invocation to cut down on the network traffic from idle
workstations.  Without this option,
.I reactivate
will still detach all attached filesystems periodically, by keeping a
count of how many times it has been invoked.
.TP
.B \-prelogin
causes
.I reactivate
to perform only the *'d tasks listed above, and only
if PUBLIC is set to true on the workstation. If PUBLIC is false,
.I reactivate
will simply exit. The purpose of this option is to provide
.I xlogin
a facility for making sure a PUBLIC workstation is as clean as it
ought to be before a new user logs in. Specifically, this means making
sure that no other users are logged on or have running processes, and
that remote access is turned off. A full invocation of the script
isn't used for this purpose in order to minimize time a user has to
wait to log in after the previous user has logged out.

In the absence of this option,
.I reactivate
performs all listed tasks.
.B \-prelogin
and
.B \-detach
may not be specified simultaneously.

.SH FILES
.DT
.nf
/var/athena/clusterinfo		These files contain the information
/var/athena/clusterinfo.bsh	received from the nameserver.
/etc/athena/rc.conf			Contains configuration variables
/etc/passwd.local			Default contents of password file
/etc/group.local			Default contents of group file
/etc/athena/reactivate.local	Optional local additions
/etc/nologin				Disables logins
/var/athena/reactivate.pid	Contains reactivate process ID
/var/athena/reactivate.count	Contains reactivate invocation count
.fi
.SH SEE ALSO
dm(8), xlogin(8), save_cluster_info(8), access_on(1) and access_off(1),
attach(1) and detach(1), fsid(1), hesiod(3), zhm(8)
