#!/bin/sh

case "$HOSTTYPE" in
sun4)
	cat "$LIBDIR/solaris24-251"		>> "$DEADFILES"
	echo "/etc/athena/login/menu16"		>> "$DEADFILES"
	echo "/etc/athena/solaris_reconf"	>> "$DEADFILES"
	echo "/usr/bin/csh.sun"			>> "$DEADFILES"
	echo "/usr/lib/sendmail.nomx"		>> "$DEADFILES"
	echo "/etc/mail/sendmail.fc"		>> "$DEADFILES"

	echo "/.cshrc"				>> "$CONFCHG"
	echo "/etc/mail/sendmail.cf"		>> "$CONFCHG"
	echo "/etc/inet/inetd.conf"		>> "$CONFCHG"
	echo "/etc/inet/services"		>> "$CONFCHG"

	echo "TRACKOS=true"			>> "$CONFVARS"
	echo "NEWOS=true"			>> "$CONFVARS"
	echo "NEWUNIX=true"			>> "$CONFVARS"
	echo "NEWBOOT=true"			>> "$CONFVARS"

	echo "appletalk"			> "$AUXDEVS"

	# Convert /bin/csh to /bin/athena/tcsh in /etc/passwd.
	rm -f /etc/passwd.old /etc/passwd.local.old
	sed -e 's,:/bin/csh$,:/bin/athena/tcsh,' /etc/passwd > /etc/passwd.new
	ln /etc/passwd /etc/passwd.old
	mv /etc/passwd.new /etc/passwd
	if [ -f /etc/passwd.local ]; then
		sed -e 's,:/bin/csh$,:/bin/athena/tcsh,' /etc/passwd.local \
			> /etc/passwd.local.new
		ln /etc/passwd.local /etc/passwd.local.old
		mv /etc/passwd.local.new /etc/passwd.local
	fi

	# Move /usr/lib/aliases to /etc/mail/aliases if it exists.
	if [ -f /usr/lib/aliases ]; then
		mv -f /etc/mail/aliases /etc/mail/aliases.old
		mv -f /usr/lib/aliases /etc/mail/aliases
		if [ -f /usr/lib/aliases.dir ]; then
			rm -f /etc/mail/aliases.dir
			rm -f /etc/mail/aliases.pag
			mv -f /usr/lib/aliases.dir /etc/mail/aliases.dir
			mv -f /usr/lib/aliases.pag /etc/mail/aliases.pag
		fi
	else
		# Only put aliases in CONFCHG if the admin hasn't made a
		# /usr/lib/aliases file, since all we did is remove a bunch
		# of aliases for local users in /etc/mail/aliases.
		echo "/etc/mail/aliases"	>> "$CONFCHG"
	fi

	# Mailboxes need to have mail as their group owner for
	# sendmail to be able to deliver mail there.
	chgrp -R mail /var/mail
	;;

sgi)
	echo "TRACKOS=true"			>> "$CONFVARS"
	echo "NEWOS=true"			>> "$CONFVARS"
	echo "/etc/sendmail.cf"			>> "$CONFCHG"
	echo "/etc/services"			>> "$CONFCHG"
	echo "/etc/aliases"			>> "$CONFCHG"
	echo "/etc/printcap"			>> "$CONFCHG"
	echo "/usr/etc/resolv.conf"		>> "$DEADFILES"
	echo "/etc/athena/.rc.conf.sync"	>> "$DEADFILES"
	;;

esac

echo "/etc/krb.conf.v5"				>> "$DEADFILES"
echo "/etc/named.mit"				>> "$DEADFILES"

echo "/etc/athena/inetd.conf"			>> "$CONFCHG"
echo "/etc/athena/attach.conf"			>> "$CONFCHG"

# Move cached clusterinfo files to /var/athena.
if [ -f /etc/athena/clusterinfo ]; then
	mv /etc/athena/clusterinfo /var/athena/clusterinfo
fi
if [ -f /etc/athena/clusterinfo.bsh ]; then
	mv /etc/athena/clusterinfo.bsh /var/athena/clusterinfo.bsh
fi

# Move attachtab file to /var/athena.
if [ -f /var/tmp/attachtab ]; then
	mv /var/tmp/attachtab /var/athena/attachtab
fi
if [ -f /var/tmp/attachtab.lock ]; then
	mv /var/tmp/attachtab.lock /var/athena/attachtab.lock
fi

# Move some pid files to /var/athena.
if [ -f /etc/athena/console.pid ]; then
	mv /etc/athena/console.pid /var/athena/console.pid
fi
if [ -f /etc/athena/dm.pid ]; then
	mv /etc/athena/dm.pid /var/athena/dm.pid
fi
if [ -f /etc/athena/snmpd.pid ]; then
	mv /etc/athena/snmpd.pid /var/athena/snmpd.pid
fi
if [ -f /etc/athena/inetd.pid ]; then
	mv /etc/athena/inetd.pid /var/athena/inetd.pid
fi
