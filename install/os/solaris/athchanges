#!/sbin/sh
# $Id: athchanges,v 1.10 2003-06-30 16:01:15 rbasch Exp $
# athchanges - Set up configuration files required by Athena software.

umask 022
PATH=/usr/athena/bin:/usr/bin
export PATH

# Recreate GConf schemas.
gdir=/etc/athena/gconf
rm -rf $gdir/gconf.xml.defaults
mkdir $gdir/gconf.xml.defaults
GCONF_CONFIG_SOURCE=xml::$gdir/gconf.xml.defaults
export GCONF_CONFIG_SOURCE
# athena.schemas has to be installed last in order to override
# standard GNOME defaults.
for f in $gdir/schemas/*.schemas $gdir/schemas/athena.schemas; do
  gconftool-2 --makefile-install-rule $f > /dev/null 2>&1
done

# Create pango module config.
mkdir -p /etc/athena/pango
pango-querymodules > /etc/athena/pango/pango.modules

# Create gtk module configs.
mkdir -p /etc/athena/gtk-2.0
gtk-query-immodules-2.0 > /etc/athena/gtk-2.0/gtk.immodules
gdk-pixbuf-query-loaders > /etc/athena/gtk-2.0/gdk-pixbuf.loaders

# Create fontconfig cache.  (fc-cache dumps core if HOME is not set.)
HOME=/ fc-cache -f 2>/dev/null

# Create the gstreamer global registry.
/usr/athena/bin/gst-register --gst-mask=0 > /dev/null 2>&1
